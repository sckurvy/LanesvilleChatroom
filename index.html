<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lanesville Chat</title>
  <style>
    :root{
      --bg:#ffffff; --panel:#f4f4f4; --muted:#555; --text:#000000; --accent:#9b59b6;
    }
    [data-theme="dark"]{ --bg:#2c2c34; --panel:#1e1e24; --muted:#aaa; --text:#ffffff; --accent:#9b59b6; }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial}
    body{background:var(--bg);color:var(--text);display:flex;align-items:center;justify-content:center}

    .app{width:100%;height:100%;display:grid;grid-template-rows:64px 1fr 96px;background:var(--panel)}

    header{display:flex;align-items:center;justify-content:space-between;padding:0 18px;border-bottom:1px solid rgba(0,0,0,0.1)}
    .title{display:flex;align-items:center;gap:12px;font-weight:bold;font-size:20px}
    .online-dot{width:10px;height:10px;background:#00ff00;border-radius:50%;box-shadow:0 0 5px #00ff00;margin-left:8px}

    .controls{display:flex;gap:10px;align-items:center}
    .icon-btn{width:40px;height:40px;border-radius:10px;border:0;background:transparent;color:var(--text);cursor:pointer;display:inline-flex;align-items:center;justify-content:center}

    .messages{padding:16px;overflow:auto}
    .msg{display:flex;gap:12px;padding:8px;border-radius:8px;margin-bottom:6px;background:rgba(0,0,0,0.03)}
    .avatar{width:44px;height:44px;border-radius:999px;background:var(--accent);display:flex;align-items:center;justify-content:center;font-weight:700;color:white}
    .bubble{flex:1}
    .meta{display:flex;align-items:center;gap:10px}
    .name{font-weight:700}
    .time{font-size:12px;color:var(--muted)}
    .text{margin-top:6px;white-space:pre-wrap;color:var(--text)}

    .composer{padding:14px;border-top:1px solid rgba(0,0,0,0.1);display:flex;gap:12px;align-items:center}
    .input{flex:1;min-height:56px;border-radius:16px;padding:12px 14px;border:1px solid rgba(0,0,0,0.1);outline:none;resize:none;background:#fff;color:#000}
    .send{background:var(--accent);border:0;padding:12px 16px;border-radius:12px;color:white;font-weight:600;cursor:pointer}
    .send:disabled{opacity:0.5;cursor:not-allowed}
    .img-btn{width:44px;height:44px;border-radius:50%;background:white;border:1px solid #ccc;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:bold;color:black;cursor:pointer}

    .settings-panel{position:absolute;top:74px;right:18px;background:var(--panel);padding:14px;border-radius:10px;border:1px solid rgba(0,0,0,0.1);min-width:220px}
    .settings-panel label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    .txt{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.1);background:#fff;color:#000}
    .btn{padding:10px 12px;border-radius:8px;border:0;background:var(--accent);color:white;cursor:pointer;margin-top:8px}
  </style>
</head>
<body data-theme="light">
  <div class="app">
    <header>
      <div class="title">Lanesville Chat<div class="online-dot" title="Online"></div></div>
      <div class="controls">
        <button id="settingsBtn" class="icon-btn" title="Settings">⚙️</button>
      </div>
    </header>
    <main class="messages" id="messages"></main>
    <form id="composer" class="composer" onsubmit="return false;">
      <textarea id="msgInput" class="input" placeholder="Type a message..."></textarea>
      <button type="button" class="img-btn" title="Send Image">+</button>
      <button id="sendBtn" class="send" type="submit">Send</button>
    </form>
    <div id="settings" class="settings-panel" style="display:none;">
      <label>Display Name</label>
      <input id="displayName" class="txt" placeholder="Your name" />
      <button id="saveName" class="btn">Save</button>
      <label>Admin Panel Code</label>
      <input id="adminCode" class="txt" placeholder="Enter code" />
      <button id="adminBtn" class="btn">Enter</button>
    </div>
  </div>
  <script>
    const KEY_NAME='chat_name',KEY_MSGS='chat_msgs',KEY_OWNER='chat_owner';
    let name=localStorage.getItem(KEY_NAME)||'';
    let messages=JSON.parse(localStorage.getItem(KEY_MSGS)||'[]');
    let isOwner=localStorage.getItem(KEY_OWNER)==='true';

    const messagesEl=document.getElementById('messages');
    const msgInput=document.getElementById('msgInput');
    const sendBtn=document.getElementById('sendBtn');

    function renderMessages(){messagesEl.innerHTML='';messages.forEach(m=>{
      const el=document.createElement('div');el.className='msg';
      el.innerHTML=`<div class="avatar">${m.name[0]}</div><div class="bubble"><div class="meta"><div class="name">${m.name}${m.owner?' (Owner)':''}</div><div class="time">${m.time}</div></div><div class="text">${m.text}</div></div>`;
      messagesEl.appendChild(el);
    });messagesEl.scrollTop=messagesEl.scrollHeight;}

    function addMessage(txt){if(!txt.trim())return;const now=new Date();
      const msg={name,text:txt,time:now.toLocaleString(),owner:isOwner};
      messages.push(msg);localStorage.setItem(KEY_MSGS,JSON.stringify(messages));renderMessages();msgInput.value='';}

    sendBtn.addEventListener('click',()=>addMessage(msgInput.value));
    msgInput.addEventListener('keydown',e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();addMessage(msgInput.value);}});

    document.getElementById('settingsBtn').onclick=()=>{
      const s=document.getElementById('settings');
      s.style.display=s.style.display==='none'?'block':'none';
      document.getElementById('displayName').value=name;
    };
    document.getElementById('saveName').onclick=()=>{
      name=document.getElementById('displayName').value||'Anonymous';
      localStorage.setItem(KEY_NAME,name);
      document.getElementById('settings').style.display='none';
    };
    document.getElementById('adminBtn').onclick=()=>{
      if(document.getElementById('adminCode').value==='JohnTheJohnGuy'){
        isOwner=true;localStorage.setItem(KEY_OWNER,'true');alert('Admin mode enabled');
      } else alert('Wrong code');
    };

    if(!name){name=prompt('Enter display name')||'Anonymous';localStorage.setItem(KEY_NAME,name);}
    renderMessages();
  </script>
</body>
</html>
